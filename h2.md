# Lisää vain vesi

## x) Tiivistys 

Jaswal 2020: Mastering Metasploit - 4ed: Chapter 1: Approaching a Penetration Test Using Metasploit (kohdasta [Conducting a penetration test with Metasploit](https://learning.oreilly.com/library/view/mastering-metasploit/9781838980078/B15076_01_Final_ASB_ePub.xhtml#_idParaDest-31) luvun loppuun eli "Summary" loppuun)

```
Metasploitissa käytetyt perustermit:

-Exploits: Koodinpätkä, joka suorittaessa hyödyntää kohteen haavoittuvuutta

-Payload: Koodinpätkä, joka suoritetaan kohteessa onnistuneen hyödyntämisen jälkeen.
 Määrittelee toimet, mitä haluamme suorittaa kohdejärjestelmässä.

-Auxiliary: Moduuleja, jotka tarjoavat toimintoja kuten "scanning, fuzzing, sniffing" jne.

-Encoders: Encodereita käytetään moduulien peittämiseen, jotta ne eivät jää havaituksi.

-Meterpreter: "Meterpreter is a payload that uses in-memory DLL injection stagers."
Tarjoaa monia toimintoja, joita voi suorittaa kohdejärjestelmässä.

```

Metasploitin avulla suoritettavan penauksen edut

- Open source
- Tuki massiivisille verkkotestauksille
- Metasploit testaa kaikki järjestelmät haavoittuvuuden hyödyntämiseksi, käyttämällä parametrejä kuten aliverkon ja luokittamattoman verkkotunnusten välisen reitityksen (CIDR) arvoja
- Payload generation and switching mechanism
- Poistuu puhtaammin järjestelmistä, joihin se on tunkeutunut

Case study - Metasploitin perusteet

- Tiedon kerääminen, kerätään mahdollisimman paljon tietoa kohteesta. Aktiivisten ja passiivisten skannausten avulla, kuten porttien skannaus, banner grabbing (esim. avoimissa porteissa käynnissä olevat palvelut) ja muut skannaukset.

- Tietokantojen hyödyntäminen, aina on parempi tallentaa tulokset automaattisesti ja rakentaa tietopohja, joka sisältää kohteena olevat hostit, palvelut ja haavoittuvuudet.
  ```workspace -a``` lisää uuden workspacen metasploitablessa
  
- Porttien skannaus, Metasploitin ```db_nmap``` skriptien avulla selvitetään kohteen alttiuksia haavoittuvuuksille ja kuinka kohteeseen mahdollisesti päästään käsiksi. Nmap-komentoon voidaan asettaa ```-Pn``` joka tarkoittaa "ei ping-skannausta" ja myös ```-sV``` joka tarkoittaa versioskannausta. 
 
- Uhkan mallintaminen, tapahtuu tiedusteluvaiheen jälkeen kun kohteen alttiudet haavoittuvuuksille on selvitetty. Metasploitissa voi etsiä moduuleja haavoittuvuuttavarten, moduulien tasot Metasploitissa on määritelty ```Low -> Average -> Normal -> Good -> Great -> Excellent``` Auxiliary moduulilla voi varmistaa onko kohde haavoittuvainen.
  
- Haavoittuvuuksien analysointi, Metasploitin moduuli kertoo miten hyökkäys toimii.
  
- Haavoittuvuuden hyödyntäminen ja pääsyn saaminen, Metasploitin esimerkissä hyödynnetään EternalBlue- haavoittuvuutta Windows 7 järjestelmässä. Hyökkäyksen ajamalla saadan shell-käyttöoikeus. Koska tämä yhteys voi olla epävakaa, se päivitetään vakaammaksi Meterpreter-shelliksi, jolla saavutetaan korkeimmat mahdolliset SYSTEM-oikeudet kohdejärjestelmässä.
  
- Hyödyntämisen jälkeinen kung-fu, jälkihyökkäyksen tarkoituksena on vahvistaa asemaa kun pääsy kohteeseen on saatu. Pyritään siirtymään turvallisempaan prosessiin, kerätä tietoja kohteesta. Esimerkissä  löydettyjen ylläpitoprosessien avulla saadan pääsy kohteen Domain Controlleriin Active Directory- ympäristössä sijaitsevan vaarantuneen koneen kautta.
