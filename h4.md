# Fuzzy

### x) Lue & Tiivistä
Karvinen 2023: [Find Hidden Web Directories - Fuzz URLs with ffuf](https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/)

Fuzz faster U fool

- ffuf on fuzzing-työkalu HTTP-fuzzaukseen erittäin hyvä
- Fuzzer lähettää kymmeniä tai jopa miljoonia HTTP-pyyntöjä palvelimelle, tavoitteena löytää poikkeamia

Yleisimpiä fuzzauksen kohteita:
```
GET-parametrien nimet ja arvot
HTTP-otsikot - Host, authentication, cookies, proxy headers jne.
POST data - lomakekentät, JSON-pyynnöt, tiedostot jne.
```
 Mitä syötteitä fuzzerille annetaan:
  ```
  password lists - löytää heikkoja salasanoja
  user lists - käyttäjätunnusten/sähköpostien lista
  known api paths - käyttääkö osa web-sovelluksesta jotain "sub-application" jota voi hyödyntää
  common resource paths, parameter names and values - polkuja, parametrien nimiä ja yleisiä arvoja
  mutations of valid data - annetaan esimerkkisyötteitä joita muunnellaan mutaattorilla ja lähetetään uudelleen
  ```

## Tehtävät

### a) dirfuzt-1
Kohdetiedoston dirfuzt-1 latasin ensimmäisenä 

```$ wget https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/dirfuzt-0```

Jonka jälkeen tein tiedostosta suoritettavan, antamalla ajo oikeudet käyttäjäjälle

<img width="1260" height="359" alt="image" src="https://github.com/user-attachments/assets/3474a00b-df91-4aa2-87f3-1e265c28117f" />

<img width="555" height="185" alt="image" src="https://github.com/user-attachments/assets/937c2876-2bbf-4998-9706-e1eb4b8cd088" />

Ajoin tiedoston komennolla ```./dirfuzt-1``` niinkuin ohjeissa dirfuzt-0 ja harjoituskohde oli  nyt käynnissä ```http://127.0.0.2:8000```

Tarkistin vielä selaimella oliko palvelin käynnissä.

<img width="672" height="221" alt="image" src="https://github.com/user-attachments/assets/aba281b6-055b-4b2e-9630-8188da2c5b65" />

#


ffuf asennus

```
$ sudo apt-get update
$ sudo apt-get install ffuf
```

SecLists- sanaluettelon asennus

<img width="951" height="248" alt="image" src="https://github.com/user-attachments/assets/e71ccac7-70a9-48d5-a8ce-04d3d0a6f0e6" />

Yli 4000 polkua
#
Verkkoyhteys pois päältä ennen fuffaamista

<img width="584" height="111" alt="image" src="https://github.com/user-attachments/assets/a8d929a4-acb1-4251-a1e2-53dd917187cf" />

Suoritin ffuf-komennon, mutta se ei toiminut ensimmäisellä yrityksellä. Ffuf-komento toimi, mutta tulos ei kertonut mitään.


<img width="1287" height="638" alt="image" src="https://github.com/user-attachments/assets/8d366f45-f769-4b61-98df-3817114a80aa" />

Kokeilin ensin curlilla, josta sain selville että palvelimeen ei saa yhteyttä. Mietin ensin että estääkö palomuuri portin 8000. 

<img width="1373" height="204" alt="image" src="https://github.com/user-attachments/assets/0d3716b6-1770-4789-9a59-14d095a863f7" />

Ratkaisu olikin helppo, kun hetken pähkäilyn jälkeen tajusin että olin sulkenut palvelimen ```dirfuzt-1``` piti pitää käynnissä. 
Käynnistin palvelimen uudestaan ja avasin toisen terminaalin johon ajoin ffuf komennon.

<img width="563" height="135" alt="image" src="https://github.com/user-attachments/assets/0e1da1b8-d989-4565-9f42-abbf3bd7bd97" />

Bingo!

<img width="655" height="467" alt="image" src="https://github.com/user-attachments/assets/42bb0398-205e-440c-9d40-bfb7ae702900" />

Ihan kauheesti tavaraa joten suodatetaan "Size (in bytes) (-fs)" avulla.

```$ ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ -fs 154```

<img width="855" height="522" alt="image" src="https://github.com/user-attachments/assets/cc70c560-5ab7-4678-abab-91b303cd719f" />

wp-admin

<img width="660" height="242" alt="image" src="https://github.com/user-attachments/assets/481da7f4-894a-4e3f-9128-3e4ecf9f45b0" />

.git

<img width="696" height="246" alt="image" src="https://github.com/user-attachments/assets/e38ddd58-26cb-48bb-ac35-3d543cd3ca2a" />
 
### b & c) harjoitusmaali & basic discovery

Aloitin päivittämällä paketit ja asensin dockerin ja git

```
$ sudo apt-get update
$ sudo apt-get install docker.io git
```
<img width="1397" height="285" alt="image" src="https://github.com/user-attachments/assets/80b9f3da-cb84-45ad-95af-2e580d39a776" />


curl localhost

<img width="992" height="662" alt="image" src="https://github.com/user-attachments/assets/d7f8fdb5-da5c-4e5d-bdba-d0fbededd34a" />

<img width="397" height="66" alt="image" src="https://github.com/user-attachments/assets/2da2426f-7a03-4817-8088-8dcfc23ff327" />

Otin tässä vaiheessa yhteyden internetiin pois päältä ja kokeilin fuzzata ```ffuf.me/cd/basic/FUZZ``` tuloksetta.

Fuzzasin localhostin ja tuloksena löysin "class" ja "development.log"

<img width="864" height="436" alt="image" src="https://github.com/user-attachments/assets/5dad33ec-599d-4d1b-8dfb-a8eaf398c9cd" />


### d) Content Discovery With Recursion
FFuf skannaa ensimmäisellä ajolla sanalistan polut ja löytää ```/admin```, koska käytin rekursiivistä skannausta ```-recursion```-kytkimellä
ffuf siirtyy automaattisesti ```/admin``` hakemistoon ja skannaa sen sisällön ja löytää sieltä ```/admin/users``` sekä ```/admin/users/96```

<img width="773" height="206" alt="image" src="https://github.com/user-attachments/assets/9eea27ab-ec13-4cb2-8379-fc8304e4adaf" />

### e) Content Discovery With File Extensions

Vaikka löysin hakemiston, en nää välttämättä sen sisältöä. Jos löydän esimerkiksi hakemiston ```/logs``` on todennäköistä, että siellä on tiedostoja jonka pääte on ```.log```. 

```-e``` extension-kytkin liittää automaattisesti määrittelemäni tiedostopäätteen jokaisen sanalistassa olevan sanan perään.
Ilman sitä ffuf olisi kokeillut vain ```/logs/users```

<img width="808" height="68" alt="image" src="https://github.com/user-attachments/assets/7ed001a6-684d-4295-8bdd-74155a6eddbd" />

### f) No 404 Status

Epätarkkoja HTTP-vastauksia, eli sama kuin dirfuzt-1 tehtävässä, suodatetaan ```-fs``` filter size- kytkimen avulla, jonka jälkeen löytyy ainut todellinen tiedosto "secret"

<img width="789" height="649" alt="image" src="https://github.com/user-attachments/assets/c63a907c-1b4f-4447-85a5-632ab0d03c24" />

<img width="804" height="50" alt="image" src="https://github.com/user-attachments/assets/5e11b389-3fba-42b2-9e1b-d165797dfe32" />

### g) Param Mining

Etsitään puuttuvia parametrejä "Required Parameter Missing" ja 400 Bad Request. Käyttämällä ```-w```- kytkintä ja sanalistaa jossa on yleisiä parametrien nimiä, ffuf löysi parametrin "debug"

<img width="822" height="56" alt="image" src="https://github.com/user-attachments/assets/3e49e0e4-0954-4d25-8c38-65648910dca1" />

### h) Rate Limited

Liian monta pyyntöä johtaa yleensä virheeseen "429 Too Many Requests". Ensimmäinen komento ```ffuf -w ~/wordlists/common.txt -u http://ffuf.test/cd/rate/FUZZ -mc 200,429``` ylittää 50 pyyntöä sekunnissa

toiseen komentoon lisätään ```-t 5``` mikä rajoittaa pyynnöt viiteen ja ```-p 0.1``` lisää viiveen 0.1 sekuntiin
```
ffuf -w ~/wordlists/common.txt -t 5 -p 0.1 -u http://ffuf.test/cd/rate/FUZZ -mc 200,429
```



<img width="892" height="478" alt="image" src="https://github.com/user-attachments/assets/7d45dcc0-3e2d-4e32-9f87-69fdfc7124e0" />


### i) Subdomains - Virtual Host Enumeration
Sama IP-osoite isännöi useita verkkosivustoja

<img width="867" height="442" alt="image" src="https://github.com/user-attachments/assets/48207446-c892-42f0-97d4-577912115323" />








### Lähteet

[https://terokarvinen.com/tunkeutumistestaus](https://terokarvinen.com/tunkeutumistestaus)

Karvinen 2023: [Find Hidden Web Directories - Fuzz URLs with ffuf](https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/)

[https://terokarvinen.com/2023/fuffme-web-fuzzing-target-debian](https://terokarvinen.com/2023/fuffme-web-fuzzing-target-debian)

ffuf README.md - [https://github.com/ffuf/ffuf/blob/master/README.md](https://github.com/ffuf/ffuf/blob/master/README.md)

Hoikkala "joohoi" 2020: [Still Fuzzing Faster (U fool).](https://www.youtube.com/watch?v=mbmsT3AhwWU) In HelSec Virtual meetup #1.

ffuf Me - Target Practice for FFUF - [https://github.com/BuildHackSecure/ffufme/blob/main/README.md](https://github.com/BuildHackSecure/ffufme/blob/main/README.md)
