# Syyskuu2025!

##  Lue/katso/kuuntele ja tiivistä

- Järjestelmät ei tallenna salasanoja, vaan hash-arvoja salasanoista
- Hash-arvot ovat yksisuuntaisia
- Hash- algoritmijä on erilaisia, yleisiä ovat esim. SHA (Secure Hash Algorithm) joka sisältää SHA-1, SHA-2 (SHA256, SHA512) ja SHA-3 
- Vanhoihin, jo kräkättyihin algoritmeihin kuuluu esim MD5
- Modernimmat salasanojen hash- algoritmit: Argon2id, bcrypt, and PBKDF2
  
#  HashCat
  
- Työkalu salasanojen tiivisteiden murtamiseen
- Tiedosto esim. ```rockyou.txt``` sisältää miljoonia sanoja, HashCat yrittää selvittää syötteen perusteella mikä salasana tuotti identtisen tiivisteen
- HashCat tarvitsee tietää mitä hash-algoritmia murretaan, hashid avulla voidaan selvittää helposti

 # John The Ripper
  
- Salasanojen murtotyökalu
- Hyvä erikoisimmille salasanoille ja tiedostoformaateille esim. salasanalla suojattuihin ZIP-tiedostoihin

- Käytä vahvoja salasanoja
- Salasanojen murtaminen helpottuu kokoajan kun CPU:t ja GPU:t paranevat
- Hash-funktion "Suolaaminen" salting vaikeuttaa salasanan murtamista

  ## Tehtävät

  ### a) hashcat

  Asensin tunnilla hashcatin ja hashid

  ```
  $ sudo apt-get update && sudo apt-get -y install hashid hashcat wget
  
  ```
  Latasin rockyou- sanakirjan, joka sisältää yli 14 miljoonaa sanaa. Sen jälkeen hashid:n avulla selvitin esimerkkisalasanan: ```6b1628b016dff46e6fa35684be6acc96``` hashcat mode 0 on md5 hash-tyyppi jota yritetään murtaa tässä tapauksessa

  <img width="708" height="533" alt="image" src="https://github.com/user-attachments/assets/a1c2e357-6659-48af-bee3-e1b1f337d59f" />

Sitten ajoin hashcat komennon ```-m 0``` hash mode jonka sain hashid avulla selvitettyä

<img width="1418" height="613" alt="image" src="https://github.com/user-attachments/assets/dfbb0612-793f-4ba7-8024-4d6607423294" />
<img width="1415" height="676" alt="image" src="https://github.com/user-attachments/assets/964433cd-9623-4272-b180-1d44ab9485f1" />
<img width="1416" height="288" alt="image" src="https://github.com/user-attachments/assets/35dfea05-cdda-4b8a-be87-9bddaf8d4c1a" />

Ja tulos löytyi ja murrettu salasana oli: summer

<img width="542" height="85" alt="image" src="https://github.com/user-attachments/assets/bd63a1a6-ca9a-4de8-8971-a21910fc5881" />

### c) john the ripper

Aloitin asentamalla ohjeiden mukaan john the ripperin prerequisites paketteja, mutta ```zlib-gst``` ei löytynyt joten jätin sen lataamatta. Katsotaan myöhemmin tarvitseeko etsiä sille vastaavaa.

<img width="280" height="53" alt="image" src="https://github.com/user-attachments/assets/24b5c16e-d144-4f56-8824-0bd015b06269" />


<img width="654" height="104" alt="image" src="https://github.com/user-attachments/assets/54555a0c-f57a-430c-a023-221c387bc1df" />

Kloonasin projektin githubista ```$ git clone --depth=1 https://github.com/openwall/john.git``` 

Compile from source.

```
$ cd john/src/
	
$ ./configure
```
Configure havaitsee  ympäristön ja luo Makefile-tiedoston ‘make’-komentoa varten.
Jos jotain riippuvuuksia puuttuu niin antaa varoituksia tai virheilmoituksen.

<img width="656" height="466" alt="image" src="https://github.com/user-attachments/assets/2c1b2625-7c8d-454b-8603-f526026ad5de" />

Ei tullut mitään virheilmoituksia, joten en asentanut muuta ja ajoin ```$ make -s clean && make -sj4```

<img width="346" height="130" alt="image" src="https://github.com/user-attachments/assets/d3e74236-5993-41fe-ad61-2c004203d419" />

<img width="983" height="163" alt="image" src="https://github.com/user-attachments/assets/55b92f93-e1e5-4395-913e-13cdf58f8ea6" />

John the Ripper on nyt asennettu joten lähdin kokeilemaan [Password Protected ZIP](https://terokarvinen.com/2023/crack-file-password-with-john) esimerkkisalasanan murtamista. ALoitin lataamalla ZIP-filen 

```
$ wget https://TeroKarvinen.com/2023/crack-file-password-with-john/tero.zip
```
ZIP-salasanan murtamisessa on kaksi vaihetta. Ensin purin hashin uuteen "tero.zip.hash" tiedostoon ja sen jälkeen suoritin johnilla sanakirjahyökkäyksen purettua hash-arvoa vastaan. Salasana oli "butterfly"

<img width="827" height="269" alt="image" src="https://github.com/user-attachments/assets/f5d94fc2-2736-4131-a72a-29ecfa731c26" />

<img width="608" height="164" alt="image" src="https://github.com/user-attachments/assets/f05c6ba0-8801-4d93-898c-f06dddeb1218" />

### e) Tiedosto

Loin 7zip tiedoston, koska se tuli ensimmäisenä mieleeni joten loin tiedoston komennolla ``` $ tar -cf salattu.tar salainen```

<img width="595" height="384" alt="image" src="https://github.com/user-attachments/assets/66b8c424-dc91-40b2-9be1-92d538fc6567" />

Tein hashin 

<img width="915" height="64" alt="image" src="https://github.com/user-attachments/assets/898d3872-7a13-4c83-9bfd-ab5409e28f1e" />

Ajoin sanakirjahyökkäyksen hash-arvoa vastaan. Tässä kesti yllättävän kauan vaikka valitsin tahallaan helpon salasanan. Vaihdoin taktiikkaa ja ajoin sanakirjahyökkäyksen omalla sanakirjallani, koska en jaksanut odottaa.

<img width="809" height="281" alt="image" src="https://github.com/user-attachments/assets/201596c2-b6b8-4b72-b7a9-a8d35594315d" />

salasanan murtaminen onnistui.

### f) tiiviste

Aloitin tekemällä uuden käyttäjän "viima" ja asetin sille helposti murrettavan salasanan. Ensimmäisenä on selvitettävä käyttäjän salasana-hash. Linuxissa salasana-tiivisteet tallennetaan ```/etc/shadow``` johon pääsee käsiksi root-käyttäjällä.

Otin hashin talteen komennolla ```$ sudo cat /etc/shadow | grep "viima" >viima.hash```

<img width="467" height="42" alt="image" src="https://github.com/user-attachments/assets/0b4cfde6-7ca5-449c-991d-1571cf9e029d" />

<img width="801" height="59" alt="image" src="https://github.com/user-attachments/assets/e915c1a9-dd5f-4ddc-9fbb-c334c53bbf3a" />

Tässä kohdassa jäin jumiin, enkä saanut murrettua salasanaa. Selvitin hash-tyypin ```$y$```- alkava hash on yescrypt-hash, jota en pystynyt murtamaan koska john ei tunnistanut sitä, koska se on uudempi ja vaatii enemmän muistia.

Päätin mennä helpomman kautta ja tein SHA-512- hashin komennolla ```openssl passwd -6```

<img width="1216" height="109" alt="image" src="https://github.com/user-attachments/assets/01a7fa75-82f4-417b-9da9-b409a4e60507" />


Tein tiedoston joka sisältää generoidun salasanatiivisteen, ja ajoin salasanakirjahyökkäyksen tiedostoon

<img width="872" height="192" alt="image" src="https://github.com/user-attachments/assets/745aa441-afbb-45b2-8d48-a2e57d16cc02" />

### g) msfvenom

Raportoin tämän myöhemmin 


### Lähteet

Karvinen 2022:[ Cracking Passwords with Hashcat](https://terokarvinen.com/2022/cracking-passwords-with-hashcat/). Luettu 19.9.2025

Karvinen 2023:[ Crack File Password With John](https://terokarvinen.com/2023/crack-file-password-with-john/) Luettu 19.9.2025

Santos et al 2017: [Security Penetration Testing - The Art of Hacking Series LiveLessons: Lesson 6: Hacking User Credentials](https://learning.oreilly.com/videos/security-penetration-testing/9780134833989/9780134833989-sptt_00_06_00_00) Katsottu 19.9.2025


OWASP Cheat Sheet Series: [Password Storage Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html) 
[Encrypting and decrypting archives with 7-Zip](https://www.redhat.com/en/blog/encrypting-decrypting-7zip) Luettu 22.9.2025


