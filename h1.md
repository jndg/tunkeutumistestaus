# Kybertappoketju

## x) Lue & tiivistä

[Herrasmieshakkerit](https://www.youtube.com/watch?v=PJW9r_U05dY)

-tekee podcastejä tietoturvaan liittyen. 

-Kuuntelin vastaamo jakson, mielenkiintoista settiä rikosylikomisarion näkökulmasta


[Hutchins et al 2011: Intelligence-Driven Computer Network Defense Informed by Analysis of Adversary Campaigns and Intrusion Kill Chains](https://lockheedmartin.com/content/dam/lockheed-martin/rms/documents/cyber/LM-White-Paper-Intel-Driven-Defense.pdf), chapters Abstract, 3.2 Intrusion Kill Chain.


Tunkeutumisen ydin:
Luotetun rajan rikkominen -> läsnäolon vakiinnuttaminen -> tavoitteiden edistäminen (hyökkäystoimet)

-Tunkeutumisen tappoketju

1. tiedustelu
2. aseistaminen
3.  toimitus
4. hyödyntäminen
5. asennus
6.  komento ja hallinta 
7. toimet kohteisiin

[The Art of Hacking (Video Collection): 4.3 Surveying Essential Tools for Active Reconnaissance](https://learning.oreilly.com/videos/the-art-of/9780135767849/9780135767849-SPTT_04_00)

-Nmap on monipuolinen ja vakaa portti skanneri

-Masscan on nopein portti skanneri

-Udpprotoscanner on nopea UDP portti skanneri

[KKO:2003:36](https://finlex.fi/fi/oikeuskaytanto/korkein-oikeus/ennakkopaatokset/2003/36)

-Diaarinnumero: R2001/678 Tietomurto

-Porttiskannaus tapaus mennyt korkeimpaanoikeuteen asti

-Rangaistuksena sakkoja

# Kalin asentamista ja ensikosketus

## a) Kalin asennus VirtualBox

Käytän asennukseen vagrantia

https://portal.cloud.hashicorp.com/vagrant/discover/kalilinux/rolling

```
vagrant init kalilinux/rolling --box-version 2025.2.1
```

```
vagrant up
```
<img width="647" height="245" alt="image" src="https://github.com/user-attachments/assets/3bc6476d-71e4-492e-abec-8a80e3470967" />

## b) Kalin irroittaminen verkosta

Irroitin Kalin verkosta, VirtualBoxin Network asetuksista. "Attached to: Not attached"

<img width="671" height="170" alt="image" src="https://github.com/user-attachments/assets/301346ee-cb0e-4a5d-a43e-ecced25637f5" />

Ja testiä vielä perään

<img width="1042" height="296" alt="image" src="https://github.com/user-attachments/assets/f97aa71a-6b88-436b-a9b4-fa6bb6346dec" />

## c) Porttiskannaus

```
$ nmap -T4 -A localhost
```

-T4 nopeuttaa skannausta
-A "Aggressive scan"

<img width="634" height="425" alt="image" src="https://github.com/user-attachments/assets/955c9ffb-0862-46dc-9d2f-c499d572057c" />

Tuloksista voi päätellä, että 999 porttia on suljettu

SSH-palvelu kuuntelee portissa 22

OS - tunnistaa Linuxin


## d) Asenna kaksi demonia

Laitoin verkon päälle, päivitin paketit ja latasin apachen ja openssh-server

<img width="647" height="269" alt="image" src="https://github.com/user-attachments/assets/c1869378-d6f5-4416-83b6-eae07d6ca4d5" />

Ja portti skannasin uudelleen

<img width="630" height="364" alt="image" src="https://github.com/user-attachments/assets/c705092c-28af-497b-9316-c7a0726c470a" />

Tuloksista päätellen apache2 pyörii portissa 80 ja OpenSSH portissa 22

## e) Metasploitable 2

Latasin Metasploitable 2 osoitteesta: https://sourceforge.net/projects/metasploitable

<img width="713" height="463" alt="image" src="https://github.com/user-attachments/assets/13ae024c-e435-4895-ba65-063dc88ead06" />

## d) Kali ja Metasploitable 2 yhdistäminen samaan verkkoon
Tein virtuaalikoneen ohjeita seuraamalla ja VirtualBoxin asetuksista "Network Manager" tein NAT-verkon


<img width="844" height="616" alt="image" src="https://github.com/user-attachments/assets/4705795c-5292-4a52-abc9-aeb861411a48" />

KALI VirtualBox Network asetukset:

<img width="701" height="179" alt="image" src="https://github.com/user-attachments/assets/213fc51c-3638-4d59-ba53-05ff0f0f89c2" />

<img width="684" height="180" alt="image" src="https://github.com/user-attachments/assets/76cf7966-e6d9-4b16-b969-cc92225d3e80" />


Metasploitable 2 VirtualBox Network asetukset:

<img width="676" height="170" alt="image" src="https://github.com/user-attachments/assets/b8622bac-86bf-4a67-87f8-2659b804410b" />

Nyt Kalin pitäisi toimia NATin kautta ja Metasploitable vain host-only yhteys

Seuraavaksi menin Metasploitableen ja tarkistin IP-osoitteen 

<img width="678" height="318" alt="image" src="https://github.com/user-attachments/assets/e9e2b896-73dc-4a26-a4d6-38653915410c" />

Tämän jälkeen Kali linuxille takaisin kokeilemaan pingiä

<img width="645" height="228" alt="image" src="https://github.com/user-attachments/assets/73e83c41-1948-4c14-addd-90c0274a0989" />

## g) Etsi Metasploitable 
Kali koneella porttiskannasin host-only verkon 

<img width="634" height="222" alt="image" src="https://github.com/user-attachments/assets/05b09a4a-0379-48d9-8825-9d13e3cf3462" />


 Tuloksien perusteella löytyi 3 hostia

<img width="1082" height="478" alt="image" src="https://github.com/user-attachments/assets/1e2d6725-a975-4499-8bda-e1c4be86a690" />

## h) Porttiskannaus metaspoitable

Porttiskannasin metaspoitable IP:n 

```
$ nmap -A -T4 -p-
```

 Sain pitkän listan avoimia portteja

 
OpenSSH portissa 22:

 <img width="672" height="72" alt="image" src="https://github.com/user-attachments/assets/43e648c3-87b1-4999-87da-b2287b448069" />
 
Voi sisältää heikkoja avaimia

 Apache portissa 80:
 
 <img width="604" height="52" alt="image" src="https://github.com/user-attachments/assets/214ebde6-c6b7-40a8-baef-b572be39fb98" />
 
 Haavoittuva useille hyökkäyksille esim. vanha versio

 MySQL portissa 3306:

 <img width="728" height="176" alt="image" src="https://github.com/user-attachments/assets/bbfba66d-451a-4e89-98f4-57978f7f8d96" />





## Lähteet

https://terokarvinen.com/tunkeutumistestaus
https://lockheedmartin.com/content/dam/lockheed-martin/rms/documents/cyber/LM-White-Paper-Intel-Driven-Defense.pdf
https://learning.oreilly.com/videos/the-art-of/9780135767849/9780135767849-SPTT_04_00
