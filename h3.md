# Täysin laillinen sertifikaatti

### x) 
OWASP 2021: OWASP Top 10:2021, [A01:2021 – Broken Access Control](https://owasp.org/Top10/A01_2021-Broken_Access_Control)
-Broken Access Control eli toimimaton pääsynvalvonta
-Hyökkääjä pääsee käsiksi salaisiin tai suojattuihin tiedostoihin
-Saa käsiksi käyttäjäoikeudet

PortSwigget Academy, [Insecure direct object references (IDOR)](https://portswigger.net/web-security/access-control/idor)
-Insecure direct object references (IDOR)
-pääsynvalvonnan heikkous
-käyttää suoraan käyttäjän antamia tietoja tiedostojen tai tietojen hakemiseen

PortSwigget Academy, [Path traversal](https://portswigger.net/web-security/file-path-traversal)
-antaa hyökkääjälle mahdollisuuden manipuloida sovelluksen tiedostopolkuja
-"kiivetään" hakemistopolkua jotta päästään käsiksi suojattuihin tiedostoihin

PortSwigget Academy, [Cross-site scripting](https://portswigger.net/web-security/cross-site-scripting)
- Cross-site scripting (XSS)
- Injektiohyökkäys, syötetään haitallista Javascriptiä verkkosivulle
- Reflected XSS
- Stored XSS
- DOM XSS
  
# a) Totally Legit Sertificate

OWASP ZAP asennus ja sertifikaatti

Aloitin asentamalla Kaliin ZAPin ``` $ sudo apt-get install zaproxy ```
Käynnistin ZAP-sovelluksen ja löysin "Server Certificates"

<img width="1139" height="779" alt="image" src="https://github.com/user-attachments/assets/672caed4-9de6-4a53-a0df-37de01267472" />

Generoin uuden sertifikaatin ja tallensin sen .cer tiedostona

Lisäsin sertifikaatin firefoxiin Certificate Manager

<img width="676" height="449" alt="image" src="https://github.com/user-attachments/assets/0dfd4abd-f9b0-4dbf-b1af-30fe07d1e221" />


## b) FoxyProxy

Asensin FoxyProxy Standard lisäosan Firefoxiin

<img width="1362" height="694" alt="image" src="https://github.com/user-attachments/assets/b3a3d3b3-7f7c-4eeb-ad15-f8b6380eb447" />

Lisäsin uuden proxyn ja patternsit

<img width="1205" height="460" alt="image" src="https://github.com/user-attachments/assets/33745ee4-9a0e-4a10-b794-2d92bd687894" />

<img width="324" height="47" alt="image" src="https://github.com/user-attachments/assets/56ec3395-a261-4eab-9e66-cd32ff3d5342" />
<img width="252" height="22" alt="image" src="https://github.com/user-attachments/assets/80262911-d0eb-4feb-b4e0-58988ed68cb6" />

## c) Reflected XSS into HTML context

Luin portswiggerin [Exploiting cross-site scripting vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/exploiting)

Katsoin myös [portswiggerin](https://www.youtube.com/watch?v=ecuiE83zvqY) oman videon, jossa selitettiin tehtävää

Palvelin palauttaa syötteen suoraan HTML:ään ilman suodatusta
Jos sivustolla on turvallinen haku, se poistaa kaikki HTML- tai JavaScript-tunnisteet ja näyttää tuloksen sellaisenaan. Tässä labissa hyödynnetään vaarallista hakua, jossa sivusto ei puhdista käyttäjän syötettä oikein ja voimme syöttää hakukenttään JavaScript- koodin

<img width="688" height="64" alt="image" src="https://github.com/user-attachments/assets/9269f42a-a209-4d6f-8c46-b72c00ff8352" />


<img width="1172" height="497" alt="image" src="https://github.com/user-attachments/assets/5457e837-bbbb-4582-a38b-758153aa9120" />



## d) Stored XSS into HTML context
Stored Cross-Site Scripting labissa hyödynnetään haavoittuvuutta blogin kommenttikentässä. Palvelin tallentaa kommentin tietokantaan ja näyttää sen muille, ilman validointia. Tässä labissa hyödynnetään haavoittuvuutta ja kirjoitan JavaScript- koodin kommenttikenttään, jossa ei ole käytetty syötteen validointia eikä HTML-enkoodausta ja selain suorittaa koodin.

<img width="896" height="656" alt="image" src="https://github.com/user-attachments/assets/80213218-8e58-49ef-bca2-12cd3cbb87ea" />

## e)
Labeissa käytetyt koodit toimii testinä, mutta todelliset hyödyt Cross-site scriptingillä ovat vakavia.
XXS haavoittuvuuksilla voidaan esimerkiksi varastaa istuntotietoja, tartuttaa käyttäjän tietokoneen jollain muulla haittaohjelmalla joka antaa etäkäyttö oikeudet hyökkääjälle tai ohjata phishing-sivustolle
## fgh)
File path traversal, simple case
Tavoitteena lukea esim. ```etc/passwd``` joten tässä labissa haavoittuvuus on sivuston kuvissa ja niiden parametreissä. Korvataan polku ```/image?filename=../../etc/passwd```

<img width="538" height="151" alt="image" src="https://github.com/user-attachments/assets/4bd93c75-c332-4106-88b4-18a57ae9251d" />

File path travesal, travesal sequences blocked with absolute bypass

Tavoitteena on ohittaa ```../``` suodatus

File path travelsal, travesal sequences stripped non-recursively 

Jos palvelin muuttaa ```../``` yhdesti voidaan kokeilla ohittaa suodatus


## i)

Tässä labissa tallennetaan käyttäjien chat-lokit suoraan palvelimen tiedostojärjestelmään joka hakee ne staattisten URL-osoitteiden avulla

Tässä labrassa on hankittava carloksen tilitiedot, jotta voin ladata hänen chat-lokit.




# Lähteet

https://terokarvinen.com/tunkeutumistestaus
https://github.com/BuildHackSecure/ffufme
https://terokarvinen.com/2023/fuffme-web-fuzzing-target-debian/#practice
https://www.youtube.com/watch?v=ecuiE83zvqY
